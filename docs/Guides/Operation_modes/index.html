<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Guides/Operation_modes" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Operation Mode based Control Types | S2 Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://flexiblepower.github.io/s2-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://flexiblepower.github.io/s2-documentation/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://flexiblepower.github.io/s2-documentation/docs/Guides/Operation_modes/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Operation Mode based Control Types | S2 Documentation"><meta data-rh="true" name="description" content="Similarities"><meta data-rh="true" property="og:description" content="Similarities"><link data-rh="true" rel="icon" href="/s2-documentation/img/logo-s2-no-text.svg"><link data-rh="true" rel="canonical" href="https://flexiblepower.github.io/s2-documentation/docs/Guides/Operation_modes/"><link data-rh="true" rel="alternate" href="https://flexiblepower.github.io/s2-documentation/docs/Guides/Operation_modes/" hreflang="en"><link data-rh="true" rel="alternate" href="https://flexiblepower.github.io/s2-documentation/docs/Guides/Operation_modes/" hreflang="x-default"><link rel="stylesheet" href="/s2-documentation/assets/css/styles.84017f8c.css">
<script src="/s2-documentation/assets/js/runtime~main.5d56f1ea.js" defer="defer"></script>
<script src="/s2-documentation/assets/js/main.f00a226a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/s2-documentation/img/logo-s2-no-text.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/s2-documentation/"><div class="navbar__logo"><img src="/s2-documentation/img/logo-s2-no-text.svg" alt="S2 Standard" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/s2-documentation/img/logo-s2-no-text.svg" alt="S2 Standard" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">The S2 Standard</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/s2-documentation/docs/API/Common/Commodity/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/flexiblepower/s2-documentation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/s2-documentation/docs/API/Common/Commodity/">API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/s2-documentation/docs/Guides/Architecture/">Guides</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/Architecture/">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/Common_concepts/">Common_concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/Control_Types/">Control Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/Example_EV/">S2 examples for electric vehicles</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/Example_HP/">S2 examples for heat pumps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/Home/">S2 Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/s2-documentation/docs/Guides/Operation_modes/">Operation Mode based Control Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/S2-example-for-PV/">S2 example for PV installations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/State_of_communication/">State of S2 session</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/discovery_scenarios/">discovery_scenarios</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/s2-documentation/docs/Guides/why_the_s2_approach/">Why the S2 approach?</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Operation Mode based Control Types</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="similarities">Similarities<a href="#similarities" class="hash-link" aria-label="Direct link to Similarities" title="Direct link to Similarities">​</a></h2>
<p>There are three Control Types that are based on a common principle of <em>Operation Modes</em>. There three Control Types are:</p>
<ul>
<li>Operation Mode Based Control (OMBC)</li>
<li>Fill Rate Based Control (FRBC)</li>
<li>Demand Driven Based Control (DDBC)</li>
</ul>
<p>Although these Control Types differ enough to separate them into three distinct Control Types, there are some common aspects that make them similar: Operation Modes, Transitions and Timers. These concepts are explained on this page.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a-virtual-device">A virtual device<a href="#a-virtual-device" class="hash-link" aria-label="Direct link to A virtual device" title="Direct link to A virtual device">​</a></h2>
<p>The objective for a Control Type is basically for a CEM to understand what a device is capable of from an energy perspective, under which circumstances what things can be adjusted, and what the constraints are for these adjustments. And for many applications it is important that the CEM can make relatively good predictions of what will happen in certain situations. The three Operation Mode based Control Types do that in similar fashion: they model a <em>virtual, abstract device</em>.</p>
<p>Of course, in the end, it is all about controlling the <em>real, physical device</em>. But the virtual device is a helpful tool. The physical device contains a lot of details that are not relevant for a CEM. The control system of the physical device has all sorts of concerns, but the CEM is only concerned with utilizing energy flexibility. The virtual device ignores all details of the device that are not relevant to a CEM. In addition, physical devices have an enormous variety in parameters, sensors, control strategies, concerns, safeguards, and so on. It would be practically impossible to develop a CEM that can understand all the parameters of all the physical devices on the market. By making the virtual device more abstract, its concepts can be translated to all sorts of physical devices, even though internally they function very differently. As a consequence, it not always possible to make a 100% accurate description of all the behaviors and constraints in these abstractions. But the abstractions used in the control types are quite powerful, and should allow you to come pretty close.</p>
<p>The Control Types basically define how the virtual device can be described. It is the job of the RM to describe the behavior of the physical device as well as it can, in the terms of the virtual device. The RM describes how the virtual device functions, what it can do and what kind of constraints it has. It also informs the CEM about the current state of the virtual device. Based on the description of this virtual device, the CEM can make predictions of that the virtual device will do in certain situations, and when it is allowed to send which instruction to the RM. When the CEM sends an instruction for the virtual device to the RM, it is the job of RM to translate this instruction for the virtual device into an instruction to the physical device that would yield the same result. Once the physical device has changed it behavior, the RM should inform the CEM that the virtual device has changed its state accordingly.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="state-machine">State machine<a href="#state-machine" class="hash-link" aria-label="Direct link to State machine" title="Direct link to State machine">​</a></h2>
<p>The system of Operation Modes is basically based on the idea of a state machine. A state machine is a concept where there any several possible states to be in, but at any point in time there can be only one active state. The state machine can go to another state only if there exists a transition from the current active state to the next one.</p>
<p>For example, see the simple example below:</p>
<p><img decoding="async" loading="lazy" src="https://github.com/user-attachments/assets/ed1ec799-5802-4eb0-9dd9-2b6df70ab5a4" alt="SoWkIImgAStDuSh8J4bLICqjAAbKI4ajJYxAB2Z9pC_ZuehMYbNGrRLJy4zBum9YC1ie1cS7fQQK9gUc1EINfnPn8NF0icwbEJaGAJWBlowONN3r214kXzIy5A1J0G00" class="img_ev3q"></p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Details</summary><div><div class="collapsibleContent_i85q"><div class="language-plantuml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-plantuml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@startuml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hide empty description</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[*] --&gt; Off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Off --&gt; [*]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Off --&gt; ReducedPower</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ReducedPower --&gt; FullPower</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FullPower --&gt; ReducedPower</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ReducedPower --&gt; Off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FullPower --&gt; Off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@enduml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<p>A state machine always starts with the black circle, and ends with the white circle with the black circle in it. In this example you start in the state &quot;Off&quot;. From there you can go to the state &quot;ReducedPower&quot;, but not directly to &quot;FullPower&quot;, since there is no transition from &quot;Off&quot; to &quot;FullPower&quot;. In other words, you have to go through &quot;ReducedPower&quot; if you want to go to &quot;FullPower&quot;.</p>
<table><thead><tr><th>Current state</th><th>Allowed next states</th></tr></thead><tbody><tr><td>Off</td><td>ReducedPower</td></tr><tr><td>ReducedPower</td><td>Off, FullPower</td></tr><tr><td>FullPower</td><td>ReducedPower, Off</td></tr></tbody></table>
<p>Within S2, Operation Modes are basically the states from the state machine. There can be only one Operation Mode active at a certain point in time. (Note: With FRBC and DDBC you could have multiple Actuators, which each have their own state machine. So for FRBC and DDBC, there is always one active Operation Mode for each Actuator). Each Operation Mode and Transition has certain information associated with it to inform the CEM about the behavior of the device.</p>
<p>Other than the typical state machine, Operation Modes don&#x27;t have a start and end node, since the operation of a device is basically an ongoing process. When a Control Type is activated, you just start with whatever Operation Mode is currently active on the device. The RM tells the CEM which Operation Modes and Transitions exist. The RM informs the CEM about the active Operation Mode, and immediately notifies the CEM when the Operation Mode changes. The CEM can make a request (through an Instructions message) to make another Operation Mode active, but in the end it is always the RM (or the physical device) that decides which Operation Mode is active. Although not preferable, a RM can active another Operation Mode without the CEM requesting it, and it is even allowed to activate an Operation Mode even if there is no transition from the old one to the new one.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="operation-modes">Operation Modes<a href="#operation-modes" class="hash-link" aria-label="Direct link to Operation Modes" title="Direct link to Operation Modes">​</a></h2>
<p>Although the exact properties of the Operation Modes differ for the different Control Types, they all share some properties:</p>
<table><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>Unique identifier for the Operation Mode (UUID)</td></tr><tr><td>diagnostic_label</td><td>Human-readable description of the Operation Mode (for debugging purposes)</td></tr><tr><td>power_ranges</td><td>The power exchanged with the grid when this Operation Mode is active</td></tr><tr><td>running_costs</td><td><a href="https://github.com/flexiblepower/s2-ws-json/wiki/Common_concepts#costs-running-costs-and-transition-costs" target="_blank" rel="noopener noreferrer">Costs</a> associated with running this operation mode (not including energy costs)</td></tr><tr><td>abnormal_condition_only</td><td>If this Operation Mode is only to be used during <a href="https://github.com/flexiblepower/s2-ws-json/wiki/Common_concepts#abnormal-condition" target="_blank" rel="noopener noreferrer">abnormal conditions</a></td></tr></tbody></table>
<p>Note: For more details, see the data structure reference for <a href="https://github.com/flexiblepower/s2-ws-json/wiki/OMBC_messages#ombcoperationmode" target="_blank" rel="noopener noreferrer">OMBC</a>,
<a href="https://github.com/flexiblepower/s2-ws-json/wiki/FRBC_messages#frbcoperationmode" target="_blank" rel="noopener noreferrer">FRBC</a> or <a href="https://github.com/flexiblepower/s2-ws-json/wiki/DDBC_messages#ddbcoperationmode" target="_blank" rel="noopener noreferrer">DDBC</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="power">Power<a href="#power" class="hash-link" aria-label="Direct link to Power" title="Direct link to Power">​</a></h3>
<p>The most important property here is the <code>power_range</code>, which informs the CEM what the <a href="https://github.com/flexiblepower/s2-ws-json/wiki/Common_concepts#power" target="_blank" rel="noopener noreferrer">power</a> production or consumption is when the Operation Mode is active. Assuming that we use a <a href="https://github.com/flexiblepower/s2-ws-json/wiki/Common_concepts#commodityquantity" target="_blank" rel="noopener noreferrer">CommodityQuantity</a> for electricity, the Operation Modes of the previous example could be defined such that Off consumes 0 Watts, ReducedPower consumes 1000 Watts and FullPower consumes 2500 Watts. By associating this information with the Operation Mode, the CEM knows what to expect when it requests the device to go to a certain Operation Mode.</p>
<table><thead><tr><th>Property</th><th></th><th></th><th></th></tr></thead><tbody><tr><td>id</td><td>f3f...</td><td>24b...</td><td>ca5...</td></tr><tr><td>diagnostic_label</td><td>Off</td><td>ReducedPower</td><td>FullPower</td></tr><tr><td>power</td><td>0 Watts</td><td>1000 Watts</td><td>2500 Watts</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="operation-mode-factor">Operation Mode Factor<a href="#operation-mode-factor" class="hash-link" aria-label="Direct link to Operation Mode Factor" title="Direct link to Operation Mode Factor">​</a></h3>
<p>As you might have noticed, describing the power consumption or production of a device using Operation Modes, forces us to pick discrete power values. But what if we have a device that allows you to pick any power value? Imagine our example device, which only has two modes: Off, where it consumes 0 Watts, and On, where it can consume any amount of power between 1000 and 2500 Watts. How would you describe the behavior of the second mode as S2 Operation Modes?</p>
<p>One possibility is to just split up the range between 1000 and 2500 Watts in discrete steps, and define a whole list of Operation Modes for each discrete value. For example, when picking steps of 100 Watts, you would create one for 1000 Watts, on for 1100 Watts, one for 1200 Watts... all the way up until 2500. Doing so would result in a total of 17 Operation Modes, and we loose the precision of picking values that aren&#x27;t exactly rounded to a multiple of 100. Although in some cases it might be desirable to pick discrete values, S2 offers another solution.</p>
<p>When taking a closer look at the data model for Operation Modes, you might notice that the <code>power_range</code> property is actually... a range. It consist of two numbers: the start of the range and the end of the range. This allows you to cover the whole spectrum of power values the Operation Mode supports. However, when an Operation Mode only has one possible power value, the start and end of the range should just be equal to each other. This would simplify the Operation modes in our example:</p>
<table><thead><tr><th>Property</th><th></th><th></th></tr></thead><tbody><tr><td>id</td><td>a29...</td><td>48c...</td></tr><tr><td>diagnostic_label</td><td>Off</td><td>On</td></tr><tr><td>start power_range</td><td>0 Watts</td><td>1000 Watts</td></tr><tr><td>end power_range</td><td>0 Watts</td><td>2500 Watts</td></tr></tbody></table>
<p>But the CEM probably doesn&#x27;t want to have any value within the range... it wants to specify exactly which value. This is where the Operation Mode factor comes into play. When requesting the RM to go to a certain Operation Mode, the CEM also needs to indicate which value within the range it wants. But instead of directly communicating a power value in Watts, the CEM communicates the factor. The factor is a (floating point) value between 0 and 1 indicating exactly where in the range it wants the value to be. When picking the factor 0 the power value is the start of the range, when picking the value 1 the power value is the end of the range. Values in between need to be linearly interpolated.</p>
<p>You could use the following formula to calculate the power value given the factor and the power range:</p>
<p><code>power = (end power_range - start power_range) * factor + start power_range</code></p>
<p>Alternatively, you could use the following formula to calculate the factor given the power value and the power range:</p>
<p><code>factor = (power - start power_range) / (end power_range - start power_range)</code></p>
<p>For example, when the factor is 0.5, the specified power value is (2500 - 1000) * 0.5 + 1000 = 1750 Watts.</p>
<table><thead><tr><th>Factor</th><th>Power for Opertion Mode Off</th><th>Power for Opertion Mode On</th></tr></thead><tbody><tr><td>0.0</td><td>0 Watts</td><td>1000 Watts</td></tr><tr><td>0.1</td><td>0 Watts</td><td>1150 Watts</td></tr><tr><td>0.2</td><td>0 Watts</td><td>1300 Watts</td></tr><tr><td>0.3</td><td>0 Watts</td><td>1450 Watts</td></tr><tr><td>0.4</td><td>0 Watts</td><td>1600 Watts</td></tr><tr><td>0.5</td><td>0 Watts</td><td>1750 Watts</td></tr><tr><td>0.6</td><td>0 Watts</td><td>1900 Watts</td></tr><tr><td>0.7</td><td>0 Watts</td><td>2050 Watts</td></tr><tr><td>0.8</td><td>0 Watts</td><td>2200 Watts</td></tr><tr><td>0.9</td><td>0 Watts</td><td>2350 Watts</td></tr><tr><td>1.0</td><td>0 Watts</td><td>2500 Watts</td></tr></tbody></table>
<p>As you can see, when the start and end of the power_range are identical, the specified power value is always the same, regardless of the factor. This means that when an Operation Mode has the same value for the start and end of the range, it doesn&#x27;t matter which factor the CEM provides in its request.</p>
<p>As we&#x27;ve discussed, the CEM can send a request to the RM to go to a certain Operation Mode. The CEM must also always specify the factor it wants that Operation Mode to be in. A CEM is also always allowed to request the RM to go the same Operation Mode as the currently active on, but with a different factor. It is not necessary for the RM to define a Transition from that Operation Mode to itself to do so (which is usually the case for state machines).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="running-costs">Running costs<a href="#running-costs" class="hash-link" aria-label="Direct link to Running costs" title="Direct link to Running costs">​</a></h3>
<p>Optionally, a RM can specify running costs being in a certain operation mode, e.g. due to wear to the device (see <a href="https://github.com/flexiblepower/s2-ws-json/wiki/Common_concepts#costs-running-costs-and-transition-costs" target="_blank" rel="noopener noreferrer">Costs</a> for more details). The value specified is the costs in the Currency as defined in the <a href="https://github.com/flexiblepower/s2-ws-json/wiki/Common_messages#resourcemanagerdetails" target="_blank" rel="noopener noreferrer">ResourceManagerDetails</a> message per second (which is usually a very small number). The running costs are expressed as a range, but be aware that this range indicates uncertainty, and is not linked to the factor like the power_range! When there is uncertainty about the exact costs or it cannot be exactly described (e.g. because it is not directly related to the time spent within this operation mode), the range is used to express that the costs are somewhere within that range. The RM cannot provide any additional information on where in that range it expects the costs to be. If there is no uncertainty in the costs, the RM can simple provide the same value for the start and end of the range.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="transitions">Transitions<a href="#transitions" class="hash-link" aria-label="Direct link to Transitions" title="Direct link to Transitions">​</a></h2>
<p>TODO</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="timers">Timers<a href="#timers" class="hash-link" aria-label="Direct link to Timers" title="Direct link to Timers">​</a></h2>
<p>TODO</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/s2-documentation/docs/Guides/Home/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">S2 Introduction</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/s2-documentation/docs/Guides/S2-example-for-PV/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">S2 example for PV installations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#similarities" class="table-of-contents__link toc-highlight">Similarities</a></li><li><a href="#a-virtual-device" class="table-of-contents__link toc-highlight">A virtual device</a></li><li><a href="#state-machine" class="table-of-contents__link toc-highlight">State machine</a></li><li><a href="#operation-modes" class="table-of-contents__link toc-highlight">Operation Modes</a><ul><li><a href="#power" class="table-of-contents__link toc-highlight">Power</a></li><li><a href="#operation-mode-factor" class="table-of-contents__link toc-highlight">Operation Mode Factor</a></li><li><a href="#running-costs" class="table-of-contents__link toc-highlight">Running costs</a></li></ul></li><li><a href="#transitions" class="table-of-contents__link toc-highlight">Transitions</a></li><li><a href="#timers" class="table-of-contents__link toc-highlight">Timers</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Language-specific tooling</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://crates.io/crates/s2energy" target="_blank" rel="noopener noreferrer" class="footer__link-item">Rust crate<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://pypi.org/project/s2-python/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Python library<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 TNO.</div></div></div></footer></div>
</body>
</html>